{{- $name := promptStringOnce . "name" "Your full name" -}}
{{- $email := promptStringOnce . "email" "Your email address" -}}
{{- $opEnabled := promptBoolOnce . "onepassword.enabled" "Enable 1Password integration" -}}
{{- $opSSH := promptBoolOnce . "onepassword.ssh_agent" "Enable 1Password SSH agent" -}}
{{- $opServiceToken := "" -}}
{{- if $opEnabled -}}
{{-   $opServiceToken = promptStringOnce . "onepassword.service_account_token" "1Password service account token (empty for desktop app)" -}}
{{- end -}}

sourceDir: {{ .chezmoi.sourceDir | quote }}
{{- if $opServiceToken }}

# 1Password CLI mode (service account for headless/remote)
onepassword:
  mode: "service"
{{- end }}

# Global settings
progress: true
color: true

# Git settings
git:
  autoCommit: false
  autoPush: false

# Merge strategy
merge:
  command: "hx"

# CD hook
cd:
  command: "fish"

# Personal config (set during chezmoi init)
data:
  name: {{ $name | quote }}
  email: {{ $email | quote }}
  onepassword:
    enabled: {{ $opEnabled }}
    ssh_agent: {{ $opSSH }}
    service_account_token: {{ $opServiceToken | quote }}
    vault: "Development"
    # secrets: override in ~/.config/chezmoi/chezmoi.yaml
    # defaults from .chezmoidata/team.yaml
